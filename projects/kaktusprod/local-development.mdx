---
title: "Local Development"
description: "Spin up the Next.js app, optional Fastify API, Supabase functions, and Chrome extension that make up Kaktus."
---

## Prerequisites

- **Node.js 20+** (the repo uses Turbopack and modern ESM tooling).
- **npm** (ships with Node) – all scripts assume npm, though pnpm/yarn also work.
- **Supabase CLI** for running edge functions locally or inspecting the database.
- **Chrome** if you plan to test the LinkedIn extension.

> If you need production secrets or access keys, request them from the repo owner before continuing.

## 1. Clone & install

```bash
git clone https://github.com/dfwteinos/KaktusProd.git
cd KaktusProd
npm install
```

The install step pulls both the Next.js dependencies and the Fastify API tooling (Fastify, tsx, tsup, Vitest, etc.).

## 2. Configure environment variables

Copy the environment templates and fill in secrets:

```bash
cp .env.example .env        # Fastify API + shared server settings
cp .env.local.example .env.local  # Next.js / browser-facing values
```

At minimum you will need:

- **Supabase**: `NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`, `SUPABASE_URL`, `SUPABASE_SERVICE_ROLE_KEY`.
- **Auth providers**: `GOOGLE_CLIENT_ID`, `GOOGLE_CLIENT_SECRET`, and the Outlook app IDs if you plan to run the Microsoft webhook (`supabase/functions/microsoft-webhook`).
- **AI + parsing**: `MISTRAL_API_KEY`, `OPENAI_API_KEY` for the CV parsing + enrichment flows described in [`CV_PARSING_INTEGRATION.md`](https://github.com/dfwteinos/KaktusProd/blob/main/CV_PARSING_INTEGRATION.md) and `ENRICHMENT_FEATURES_SUMMARY.md`.
- **Email**: `RESEND_API_KEY` so `npm run email` can render transactional previews.
- **Webhook secrets**: `WEBHOOK_SECRET` (Google), `MS_WEBHOOK_SECRET` (Microsoft), etc., matching the expectations in [`CALENDAR_WATCH_SYSTEM.md`](https://github.com/dfwteinos/KaktusProd/blob/main/CALENDAR_WATCH_SYSTEM.md).

Keep the service-role key out of the browser bundle—only the Edge Functions and Fastify server should read it.

## 3. Run the Next.js app

```bash
npm run dev
```

This starts the App Router experience on `http://localhost:3000` and automatically boots the Supabase Realtime subscription that drives CV parsing. You should see log messages similar to:

```
[Realtime] Starting Supabase Realtime subscription for CV parsing...
[Realtime] ✅ Realtime subscription initialized successfully
```

Hot reloading is enabled, and the instrumentation hook in `src/instrumentation.ts` ensures the subscription is restarted cleanly between reloads.

## 4. Optional services

### Fastify API (REST surface)

```bash
npm run api:dev
```

The server exposes `/v1/*` resources plus an OpenAPI UI at `http://localhost:8080/docs`. Use this whenever you work on partner integrations, API keys, or webhook delivery described in [`README-API.md`](https://github.com/dfwteinos/KaktusProd/blob/main/README-API.md).

### Supabase Edge Functions

```bash
supabase functions serve
```

This mirrors production behavior for `google-webhook`, `microsoft-webhook`, `skribby-webhook`, and monitoring bots. Configure `supabase/config.toml` (already tracked in the repo) to point at your project and make sure your `WEBHOOK_SECRET` values are loaded via `supabase secrets set`.

### Chrome LinkedIn extension

```
npm run ext:build   # Build the dist/ bundle
npm run ext:zip     # Optional: create a release zip
```

Load `chrome_linkedin_extension/` as an unpacked extension in Chrome (`chrome://extensions`) and update `config.js` with your Supabase URL + anon key per [its README](https://github.com/dfwteinos/KaktusProd/tree/main/chrome_linkedin_extension).

### Email previews

```
npm run email
```

Opens the [React Email](https://react.email/) preview server pointed at `src/app/emails`.

### Tests, linting, and builds

```bash
npm run test       # Vitest (API + shared libs)
npm run lint       # next lint
npm run typecheck  # tsc -p tsconfig.api.json --noEmit
npm run build      # next build
```

Use these before opening pull requests or cutting releases. The repo also contains targeted scripts (`scripts/*.cjs` and `scripts/*.mjs`) for packaging the Chrome extension or debugging invitation jobs.

## 5. Working with Supabase data

- Apply migrations with `supabase db push` or by running the SQL files under `supabase/migrations/`.
- The `supabase/snapshots/*` directories contain exported JSON snapshots for both `dev` and `main` environments—use them to confirm policy drift.
- For destructive operations (e.g., clearing invites or demo data) prefer the helper SQL files such as `delete_user_dev.sql`.

## 6. Deployment checklist

1. Run `npm run build` and `npm run api:build` locally.
2. Make sure new SQL migrations are committed and applied to Supabase.
3. Deploy Netlify (or your chosen host) with the same environment variables as `.env.local`.
4. Deploy Supabase Edge Functions with `supabase functions deploy <name>`.
5. If the Chrome extension changed, rebuild `dist/` and re-upload the zip to the Chrome Web Store or your internal distribution channel.

Following this flow keeps the multi-surface product (web app, API, extension, and edge automations) in sync during development.

